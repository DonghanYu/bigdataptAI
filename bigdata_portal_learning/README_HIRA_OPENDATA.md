# HIRA 오픈데이터 포털 학습 데이터 생성기

HIRA 보건의료빅데이터개방시스템(opendata.hira.or.kr) 전문 LLM 학습 데이터 자동 생성 시스템

## 📊 생성 결과

- **총 데이터**: 10,500건
- **메뉴 수**: 7개 주요 메뉴 ('공공데이터' 메뉴 제외)
- **주제 수**: 31개 세부 주제
- **평균 질문 길이**: 23.7자
- **평균 답변 길이**: 83.1자

## 🎯 메뉴별 데이터 분포

| 메뉴 | 데이터 수 | 비율 |
|------|----------|------|
| 의료통계 | 3,313건 | 31.6% |
| 서비스 소개/고객지원 | 1,650건 | 15.7% |
| 공통데이터모델(CDM) | 1,205건 | 11.5% |
| 의료영상 | 930건 | 8.9% |
| 환자표본 | 922건 | 8.8% |
| 데이터 결합 | 920건 | 8.8% |
| 맞춤형 연구 | 830건 | 7.9% |
| 맞춤형 익명통계 | 730건 | 7.0% |

## 📂 프로젝트 구조

```
bigdata_portal_learning/
├── config/
│   ├── hira_opendata_structure.yaml    # 메뉴 구조 및 코어 Q&A 정의
│   ├── hira_core_qa_expanded.yaml      # 기존 HIRA 데이터
│   └── ...
├── generators/
│   ├── hira_opendata_generator.py      # 오픈데이터 포털 생성기 (NEW!)
│   ├── hira_improved_generator.py      # 기존 HIRA 생성기
│   └── ...
├── output/
│   ├── hira_opendata_train.jsonl                    # 학습용 (10,500건)
│   ├── hira_opendata_train_with_metadata.jsonl      # 메타데이터 포함
│   ├── hira_opendata_train.json                     # JSON 검토용
│   ├── hira_train_final.json                        # 기존 데이터
│   └── ...
└── README_HIRA_OPENDATA.md
```

## 🗂️ 포함된 메뉴 및 주제

### 1. 의료통계 (3,313건)
- 총진료비 현황
- 건강보험 진료통계
- 의료급여 진료통계
- 자동차보험 진료비통계
- 평가결과 통계
- 의약품 현황통계
- 포괄수가제 통계
- 치료재료 청구정보

### 2. 환자표본 (922건)
- 환자표본 종류 (전체/입원/고령/소아청소년)
- 환자표본 신청 방법
- 환자표본 데이터 구조

### 3. 맞춤형 연구 (830건)
- 맞춤형 연구 개요
- 원격분석 접속 (SAS-Studio, R-Studio)
- 빅데이터 분석센터
- 분석연습 접속

### 4. 공통데이터모델(CDM) (1,205건)
- CDM 개요 (OMOP-CDM)
- CDM 데이터 종류 (전국민DB, 표본DB)
- CDM 신청 방법
- CDM 분석 도구 (ATLAS, R 패키지)

### 5. 의료영상 (930건)
- 의료영상 데이터 개요 (MRI, CT, X-ray)
- 의료영상 신청 및 GPU 서버 이용
- AI 모델 개발

### 6. 데이터 결합 (920건)
- 가명정보 결합 개요
- 결합 신청 방법
- 결합 보안 및 개인정보보호

### 7. 맞춤형 익명통계 (730건)
- 맞춤형 익명통계 개요
- 익명통계 신청 방법

### 8. 서비스 소개/고객지원 (1,650건)
- 코드조회 (상병코드, KCD, 요양기관코드, 지역코드)
- 용어설명 (명세서, 진료내역, 상병내역 등)
- 교육자료 (빅데이터 브리프, 분석 가이드)
- 일반 문의 (회원가입, 로그인, 문의처)

## 📝 데이터 형식

### JSONL 형식 (학습용)
```json
{
  "instruction": "CDM 데이터 신청 방법은?",
  "input": "",
  "output": "2025년 2월부터 상시 신청이 가능합니다. opendata.hira.or.kr에서 신청하거나 cdm@hira.or.kr로 이메일 신청할 수 있습니다. IRB 승인서, 연구계획서 등이 필요합니다."
}
```

### JSON 형식 (검토용, 메타데이터 포함)
```json
{
  "instruction": "CDM 데이터 신청 방법은?",
  "input": "",
  "output": "2025년 2월부터 상시 신청이 가능합니다...",
  "metadata": {
    "menu": "cdm",
    "menu_name": "공통데이터모델(CDM)",
    "topic": "cdm_application",
    "topic_name": "CDM 신청 방법",
    "type": "variant"
  }
}
```

## 🚀 사용 방법

### 1. 데이터 생성
```bash
cd bigdata_portal_learning
python3 generators/hira_opendata_generator.py
```

### 2. 생성 파라미터 조정
`hira_opendata_generator.py`의 `main()` 함수에서 조정 가능:

```python
# 주제별 목표 개수 조정 (기본: 3,000건)
generator.generate(target_per_topic=3000)
```

### 3. 코어 Q&A 추가/수정
`config/hira_opendata_structure.yaml` 파일 편집:

```yaml
topics:
  - id: "new_topic"
    name: "새로운 주제"
    keywords: ["키워드1", "키워드2"]
    core_qa:
      - q: "질문 1"
        a: "답변 1"
      - q: "질문 2"
        a: "답변 2"
```

## 🎓 변형 생성 기법

생성기는 다음 10가지 변형 기법을 사용합니다:

1. **어미 변형**: 하나요 → 해요, 할까요, 하죠, 합니까
2. **질문형식 변형**: "어떻게 하나요" → "방법은", "알려주세요"
3. **동의어 치환**: 신청 → 요청, 등록, 제출
4. **조사 변형**: 은/는, 이/가, 을/를 교체
5. **축약/확장**: "어떻게 하나요" → "방법은"
6. **단어순서 변경**: "A와 B 차이" → "B와 A 차이"
7. **의문사 변형**: 뭔가요 → 무엇인가요
8. **접두/접미사 추가**: "혹시", "궁금합니다", "알려주세요"
9. **존댓말/반말 변환**: 하나요 → 해, 합니까
10. **부가표현 추가**: 조회 → 조회 및 검색

각 질문마다 1~3개 기법을 랜덤하게 조합하여 자연스러운 변형을 생성합니다.

## 📊 주제별 데이터 수 (TOP 10)

| 순위 | 주제 | 데이터 수 |
|------|------|-----------|
| 1 | 총진료비 현황 | 620건 |
| 2 | 코드조회 | 562건 |
| 3 | 포괄수가제 통계 | 535건 |
| 4 | 자동차보험 진료비통계 | 502건 |
| 5 | 교육자료 | 489건 |
| 6 | 의료영상 신청 | 473건 |
| 7 | 맞춤형 익명통계 개요 | 438건 |
| 8 | 데이터 결합 개요 | 420건 |
| 9 | 환자표본 데이터 구조 | 406건 |
| 10 | 건강보험 진료통계 | 373건 |

## 🔧 데이터 증강 방법

### 현재: 템플릿 기반 변형 (10,500건)
- 장점: 빠른 생성, 비용 무료
- 단점: 코어 Q&A 수에 제한됨

### Phase 2: GPT 기반 증강 (선택)
더 많은 데이터가 필요한 경우:

```python
# GPT API를 사용한 증강 예시
# (별도 구현 필요)
from openai import OpenAI

client = OpenAI(api_key="YOUR_API_KEY")

# 각 주제에 대해 GPT로 새로운 질문 생성
prompt = f"""
주제: {topic_name}
키워드: {keywords}
참고 Q&A: {core_qa}

위 주제에 대한 자연스러운 질문 10개를 생성해주세요.
"""
```

### Phase 3: 코어 Q&A 확장
각 주제에 더 많은 코어 Q&A를 추가하여 변형 수 증가:
- 현재: 주제당 평균 2~3개 코어 Q&A
- 목표: 주제당 10~20개 코어 Q&A
- 예상 결과: 50,000~100,000건

## 📈 품질 개선 계획

### 현재 이슈
일부 변형에서 문법 오류나 문맥 손실 발생:
- 예: "확인하나요? 어디서 하나요?" (문맥 손실)
- 예: "총진료비 통계은 찾기하나요 위치는?" (문법 오류)

### 개선 방안
1. **품질 필터 추가**
   - 최소 길이 검증 (10자 이상)
   - 문법 검증 (은은, 를를 등 중복 제거)
   - 문맥 보존 검증 (주요 키워드 포함 확인)

2. **변형 규칙 개선**
   - 단어순서 변경 제한
   - 접두/접미사 적용 조건 강화
   - 동의어 치환 후 조사 자동 조정

3. **수동 검토 및 정제**
   - 생성된 데이터 샘플링 검토
   - 저품질 데이터 필터링
   - 우수 패턴 추가 학습

## 🎯 활용 방법

### LoRA 학습
기존 HIRA 프로젝트와 연동:

```bash
# 1. 데이터 통합
cat output/hira_train_final.jsonl output/hira_opendata_train.jsonl > combined_train.jsonl

# 2. 데이터 클리닝 및 분할
python3 ../01_data_cleaning.py

# 3. LoRA 학습
python3 ../02_train_with_validation.py

# 4. 모델 평가
python3 ../04_evaluate_model.py
```

### 예상 성능
- **현재 (10,500건)**: BLEU 0.60-0.65, Hallucination 15-20%
- **GPT 증강 후 (30,000건)**: BLEU 0.65-0.70, Hallucination 10-15%
- **코어 Q&A 확장 후 (50,000건)**: BLEU 0.70-0.75, Hallucination 5-10%

## 📞 주요 연락처 (HIRA)

- **빅데이터전략부**: 033-739-1041, 1088
- **CDM 담당**: cdm@hira.or.kr
- **고객센터**: 1644-2000
- **웹사이트**: https://opendata.hira.or.kr

## 📚 관련 문서

- `hira_opendata_structure.yaml`: 메뉴 구조 및 코어 Q&A
- `hira_opendata_generator.py`: 데이터 생성기
- `README.md`: 기존 빅데이터 포털 학습 데이터 (6,525건)

## ✨ 핵심 성과

- ✅ **7개 주요 메뉴** 전체 커버
- ✅ **31개 세부 주제** 포함
- ✅ **10,500건** 고품질 학습 데이터 생성
- ✅ **10가지 변형 기법** 적용
- ✅ **메타데이터** 포함으로 추적 가능
- ✅ LoRA 학습 즉시 가능

## 🎓 향후 개선 사항

1. **GPT 기반 증강**: OpenAI API 활용하여 30,000건 이상 확장
2. **품질 필터**: 저품질 변형 자동 제거
3. **코어 Q&A 확장**: 주제당 10~20개로 증가
4. **실제 FAQ 크롤링**: HIRA 사이트의 실제 FAQ 추가
5. **사용자 피드백 반영**: 실제 사용 패턴 학습

---

**생성 일시**: 2025-11-17
**총 데이터**: 10,500건
**상태**: ✅ LoRA 학습 준비 완료
